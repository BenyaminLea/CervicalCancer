[["index.html", "Cervical Cancer Chapter 1 Introduction", " Cervical Cancer Jiawen Zhou, Lea Benyamin and Yuxin Cui 2021-11-18 Chapter 1 Introduction "],["data-sources.html", "Chapter 2 Data sources", " Chapter 2 Data sources "],["data-transformation.html", "Chapter 3 Data transformation", " Chapter 3 Data transformation "],["missing-values.html", "Chapter 4 Missing values 4.1 DataSet 4.2 Missing Values by Column 4.3 Missing Value Plots 4.4 Using Problem 2 missing value function", " Chapter 4 Missing values library(openintro) library(tidyverse) library(ggplot2) library(GGally) library(ggalluvial) library(dplyr) library(tidyverse) library(patchwork) 4.1 DataSet In our data set of risk factors of cervical cancer, the missing values were original represented by question marks “?”. We will first replace those marks with NA and then extract the first 100 rows as our example for this frist draft. df &lt;- read_csv(&quot;risk_factors_cervical_cancer.csv&quot;, show_col_types = FALSE) df &lt;- df %&gt;% na_if(&#39;?&#39;) ex &lt;- head(df, 100) ex &lt;- as.data.frame(apply(ex, 2, as.numeric)) 4.2 Missing Values by Column colSums(is.na(ex)) %&gt;%sort(decreasing = TRUE) ## STDs: Time since first diagnosis STDs: Time since last diagnosis ## 93 93 ## IUD IUD (years) ## 7 7 ## Num of pregnancies Hormonal Contraceptives ## 5 5 ## Hormonal Contraceptives (years) STDs ## 5 5 ## STDs (number) STDs:condylomatosis ## 5 5 ## STDs:cervical condylomatosis STDs:vaginal condylomatosis ## 5 5 ## STDs:vulvo-perineal condylomatosis STDs:syphilis ## 5 5 ## STDs:pelvic inflammatory disease STDs:genital herpes ## 5 5 ## STDs:molluscum contagiosum STDs:AIDS ## 5 5 ## STDs:HIV STDs:Hepatitis B ## 5 5 ## STDs:HPV Number of sexual partners ## 5 3 ## First sexual intercourse Smokes ## 2 1 ## Smokes (years) Smokes (packs/year) ## 1 1 ## Age STDs: Number of diagnosis ## 0 0 ## Dx:Cancer Dx:CIN ## 0 0 ## Dx:HPV Dx ## 0 0 ## Hinselmann Schiller ## 0 0 ## Citology Biopsy ## 0 0 4.3 Missing Value Plots Here is a missing value plots with heat map of the first 100 data rows. library(mi) datasetdf &lt;- as.data.frame(ex) x &lt;- missing_data.frame(datasetdf) ## NOTE: The following pairs of variables appear to have the same missingness pattern. ## Please verify whether they are in fact logically distinct variables. ## [,1] [,2] ## [1,] &quot;Smokes&quot; &quot;Smokes (years)&quot; ## [2,] &quot;Smokes&quot; &quot;Smokes (packs/year)&quot; ## [3,] &quot;Smokes (years)&quot; &quot;Smokes (packs/year)&quot; ## [4,] &quot;Hormonal Contraceptives&quot; &quot;Hormonal Contraceptives (years)&quot; ## [5,] &quot;Hormonal Contraceptives&quot; &quot;STDs&quot; ## [6,] &quot;Hormonal Contraceptives&quot; &quot;STDs (number)&quot; ## [7,] &quot;Hormonal Contraceptives&quot; &quot;STDs:condylomatosis&quot; ## [8,] &quot;Hormonal Contraceptives&quot; &quot;STDs:cervical condylomatosis&quot; ## [9,] &quot;Hormonal Contraceptives&quot; &quot;STDs:vaginal condylomatosis&quot; ## [10,] &quot;Hormonal Contraceptives&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [11,] &quot;Hormonal Contraceptives&quot; &quot;STDs:syphilis&quot; ## [12,] &quot;Hormonal Contraceptives&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [13,] &quot;Hormonal Contraceptives&quot; &quot;STDs:genital herpes&quot; ## [14,] &quot;Hormonal Contraceptives&quot; &quot;STDs:molluscum contagiosum&quot; ## [15,] &quot;Hormonal Contraceptives&quot; &quot;STDs:AIDS&quot; ## [16,] &quot;Hormonal Contraceptives&quot; &quot;STDs:HIV&quot; ## [17,] &quot;Hormonal Contraceptives&quot; &quot;STDs:Hepatitis B&quot; ## [18,] &quot;Hormonal Contraceptives&quot; &quot;STDs:HPV&quot; ## [19,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs&quot; ## [20,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs (number)&quot; ## [21,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:condylomatosis&quot; ## [22,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:cervical condylomatosis&quot; ## [23,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:vaginal condylomatosis&quot; ## [24,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [25,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:syphilis&quot; ## [26,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [27,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:genital herpes&quot; ## [28,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:molluscum contagiosum&quot; ## [29,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:AIDS&quot; ## [30,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:HIV&quot; ## [31,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:Hepatitis B&quot; ## [32,] &quot;Hormonal Contraceptives (years)&quot; &quot;STDs:HPV&quot; ## [33,] &quot;IUD&quot; &quot;IUD (years)&quot; ## [34,] &quot;STDs&quot; &quot;STDs (number)&quot; ## [35,] &quot;STDs&quot; &quot;STDs:condylomatosis&quot; ## [36,] &quot;STDs&quot; &quot;STDs:cervical condylomatosis&quot; ## [37,] &quot;STDs&quot; &quot;STDs:vaginal condylomatosis&quot; ## [38,] &quot;STDs&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [39,] &quot;STDs&quot; &quot;STDs:syphilis&quot; ## [40,] &quot;STDs&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [41,] &quot;STDs&quot; &quot;STDs:genital herpes&quot; ## [42,] &quot;STDs&quot; &quot;STDs:molluscum contagiosum&quot; ## [43,] &quot;STDs&quot; &quot;STDs:AIDS&quot; ## [44,] &quot;STDs&quot; &quot;STDs:HIV&quot; ## [45,] &quot;STDs&quot; &quot;STDs:Hepatitis B&quot; ## [46,] &quot;STDs&quot; &quot;STDs:HPV&quot; ## [47,] &quot;STDs (number)&quot; &quot;STDs:condylomatosis&quot; ## [48,] &quot;STDs (number)&quot; &quot;STDs:cervical condylomatosis&quot; ## [49,] &quot;STDs (number)&quot; &quot;STDs:vaginal condylomatosis&quot; ## [50,] &quot;STDs (number)&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [51,] &quot;STDs (number)&quot; &quot;STDs:syphilis&quot; ## [52,] &quot;STDs (number)&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [53,] &quot;STDs (number)&quot; &quot;STDs:genital herpes&quot; ## [54,] &quot;STDs (number)&quot; &quot;STDs:molluscum contagiosum&quot; ## [55,] &quot;STDs (number)&quot; &quot;STDs:AIDS&quot; ## [56,] &quot;STDs (number)&quot; &quot;STDs:HIV&quot; ## [57,] &quot;STDs (number)&quot; &quot;STDs:Hepatitis B&quot; ## [58,] &quot;STDs (number)&quot; &quot;STDs:HPV&quot; ## [59,] &quot;STDs:condylomatosis&quot; &quot;STDs:cervical condylomatosis&quot; ## [60,] &quot;STDs:condylomatosis&quot; &quot;STDs:vaginal condylomatosis&quot; ## [61,] &quot;STDs:condylomatosis&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [62,] &quot;STDs:condylomatosis&quot; &quot;STDs:syphilis&quot; ## [63,] &quot;STDs:condylomatosis&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [64,] &quot;STDs:condylomatosis&quot; &quot;STDs:genital herpes&quot; ## [65,] &quot;STDs:condylomatosis&quot; &quot;STDs:molluscum contagiosum&quot; ## [66,] &quot;STDs:condylomatosis&quot; &quot;STDs:AIDS&quot; ## [67,] &quot;STDs:condylomatosis&quot; &quot;STDs:HIV&quot; ## [68,] &quot;STDs:condylomatosis&quot; &quot;STDs:Hepatitis B&quot; ## [69,] &quot;STDs:condylomatosis&quot; &quot;STDs:HPV&quot; ## [70,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:vaginal condylomatosis&quot; ## [71,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [72,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:syphilis&quot; ## [73,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [74,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:genital herpes&quot; ## [75,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:molluscum contagiosum&quot; ## [76,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:AIDS&quot; ## [77,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:HIV&quot; ## [78,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:Hepatitis B&quot; ## [79,] &quot;STDs:cervical condylomatosis&quot; &quot;STDs:HPV&quot; ## [80,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:vulvo-perineal condylomatosis&quot; ## [81,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:syphilis&quot; ## [82,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [83,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:genital herpes&quot; ## [84,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:molluscum contagiosum&quot; ## [85,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:AIDS&quot; ## [86,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:HIV&quot; ## [87,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:Hepatitis B&quot; ## [88,] &quot;STDs:vaginal condylomatosis&quot; &quot;STDs:HPV&quot; ## [89,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:syphilis&quot; ## [90,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [91,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:genital herpes&quot; ## [92,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:molluscum contagiosum&quot; ## [93,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:AIDS&quot; ## [94,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:HIV&quot; ## [95,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:Hepatitis B&quot; ## [96,] &quot;STDs:vulvo-perineal condylomatosis&quot; &quot;STDs:HPV&quot; ## [97,] &quot;STDs:syphilis&quot; &quot;STDs:pelvic inflammatory disease&quot; ## [98,] &quot;STDs:syphilis&quot; &quot;STDs:genital herpes&quot; ## [99,] &quot;STDs:syphilis&quot; &quot;STDs:molluscum contagiosum&quot; ## [100,] &quot;STDs:syphilis&quot; &quot;STDs:AIDS&quot; ## [101,] &quot;STDs:syphilis&quot; &quot;STDs:HIV&quot; ## [102,] &quot;STDs:syphilis&quot; &quot;STDs:Hepatitis B&quot; ## [103,] &quot;STDs:syphilis&quot; &quot;STDs:HPV&quot; ## [104,] &quot;STDs:pelvic inflammatory disease&quot; &quot;STDs:genital herpes&quot; ## [105,] &quot;STDs:pelvic inflammatory disease&quot; &quot;STDs:molluscum contagiosum&quot; ## [106,] &quot;STDs:pelvic inflammatory disease&quot; &quot;STDs:AIDS&quot; ## [107,] &quot;STDs:pelvic inflammatory disease&quot; &quot;STDs:HIV&quot; ## [108,] &quot;STDs:pelvic inflammatory disease&quot; &quot;STDs:Hepatitis B&quot; ## [109,] &quot;STDs:pelvic inflammatory disease&quot; &quot;STDs:HPV&quot; ## [110,] &quot;STDs:genital herpes&quot; &quot;STDs:molluscum contagiosum&quot; ## [111,] &quot;STDs:genital herpes&quot; &quot;STDs:AIDS&quot; ## [112,] &quot;STDs:genital herpes&quot; &quot;STDs:HIV&quot; ## [113,] &quot;STDs:genital herpes&quot; &quot;STDs:Hepatitis B&quot; ## [114,] &quot;STDs:genital herpes&quot; &quot;STDs:HPV&quot; ## [115,] &quot;STDs:molluscum contagiosum&quot; &quot;STDs:AIDS&quot; ## [116,] &quot;STDs:molluscum contagiosum&quot; &quot;STDs:HIV&quot; ## [117,] &quot;STDs:molluscum contagiosum&quot; &quot;STDs:Hepatitis B&quot; ## [118,] &quot;STDs:molluscum contagiosum&quot; &quot;STDs:HPV&quot; ## [119,] &quot;STDs:AIDS&quot; &quot;STDs:HIV&quot; ## [120,] &quot;STDs:AIDS&quot; &quot;STDs:Hepatitis B&quot; ## [121,] &quot;STDs:AIDS&quot; &quot;STDs:HPV&quot; ## [122,] &quot;STDs:HIV&quot; &quot;STDs:Hepatitis B&quot; ## [123,] &quot;STDs:HIV&quot; &quot;STDs:HPV&quot; ## [124,] &quot;STDs:Hepatitis B&quot; &quot;STDs:HPV&quot; image(x) Here is a missing value plots by variables of the first 100 data rows. tidyex &lt;- ex %&gt;% rownames_to_column(&quot;id&quot;) %&gt;% gather(key, value, -id) %&gt;% mutate(missing = ifelse(is.na(value), &quot;yes&quot;, &quot;no&quot;)) ggplot(tidyex, aes(x = key, y = fct_rev(id), fill = value)) + geom_tile(color = &quot;white&quot;) + scale_fill_gradient(low = &quot;grey80&quot;, high = &quot;red&quot;, na.value = &quot;black&quot;) + theme_bw() 4.4 Using Problem 2 missing value function missing_plots = function(sample_data, percents){ missing_patterns &lt;- data.frame(is.na(sample_data)) %&gt;% group_by_all() %&gt;% count(name = &quot;count&quot;, sort = TRUE) %&gt;% ungroup() %&gt;% rownames_to_column(&quot;id&quot;) missing_patterns = missing_patterns %&gt;% rowwise() %&gt;% mutate(complete = ifelse(sum(c_across( names(missing_patterns)[! names(missing_patterns) %in% c(&quot;count&quot;, &quot;id&quot;)])) == 0, 1.1, 1)) complete_row = missing_patterns[missing_patterns$complete == 1.1, ]$id if (percents){ missing_patterns = missing_patterns %&gt;% mutate(count = count / nrow(sample_data) * 100) } # gather tidy_pattern = missing_patterns %&gt;% select(-count) %&gt;% gather(key, value, -c(id, complete)) # missing values by rows missing_rows = colSums(is.na(sample_data)) %&gt;% sort(decreasing = TRUE) miss_rows=data.frame(missing_rows) miss_rows = miss_rows %&gt;% rownames_to_column(&quot;id&quot;) if (percents){ miss_rows = miss_rows %&gt;% mutate(missing_rows = missing_rows/nrow(sample_data)*100) } # p1 is a plot of missing values by rows p1 = ggplot(miss_rows,aes(x = reorder(id, -missing_rows), y = missing_rows)) + geom_col(fill = &#39;light blue&#39;) + xlab(&#39;&#39;) if (percents){ p1 = p1 + ylab(&#39;% rows\\n missing&#39;) + scale_y_continuous(limits = c(0,100)) } else{ p1 = p1 + ylab(&#39;num rows\\n missing&#39;) } # p3 is a plot of missing patterns by count p3 = ggplot(missing_patterns, aes(x = count, y = fct_reorder(id, as.integer(id))))+ geom_col(fill = &#39;steelblue3&#39;, aes(alpha = complete)) + ylab(&#39;&#39;) + scale_y_discrete(limits=rev)+ scale_alpha(range = c(0.5, 1.0))+ theme(legend.position = &quot;none&quot;) if (percents){ p3 = p3 + xlab(&#39;% rows&#39;) + scale_x_continuous(limits = c(0,100)) } else{ p3 = p3 + xlab(&#39;row count&#39;) } # p2 is a plot of missing patterns by columns p2 = ggplot(tidy_pattern, aes(x = fct_reorder(key, -value, sum), y = fct_rev(fct_reorder(id,as.integer(id))), fill = value)) + geom_tile(color = &quot;white&quot;, aes(alpha = complete)) + scale_fill_manual(values=c(&quot;gray&quot;, &quot;mediumpurple1&quot;)) + xlab(&#39;variable&#39;) + ylab(&#39;missing patterns&#39;)+ scale_alpha(range = c(0.5, 1.0))+ theme(legend.position = &quot;none&quot;) if (length(complete_row) != 0){ li = levels(fct_reorder(tidy_pattern$key, -tidy_pattern$value, sum)) p2 = p2 + annotate(&#39;text&#39;, x = li[as.integer(length(li)/2)], y = complete_row, label = &#39;complete cases&#39;) } layout &lt;- &quot; AAAA# BBBBC BBBBC &quot; graphs = p1 + p2 + p3 + plot_layout(design = layout) return (graphs) } missing_plots(ex, TRUE) As shown by the graph, we can see that both columns of name STDs: Time since first diagnosis and STDs: Time since last diagnosis contains a high number of missing data. We might need to looking into these two columns and decide whether to keep them given this high volume of NAs. Other missing values takes up some portion of each column. "],["results.html", "Chapter 5 Results", " Chapter 5 Results "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
